[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "オペレーションズ・リサーチ",
    "section": "",
    "text": "Preface\nThis is a Quarto book.\nTo learn more about Quarto books visit https://quarto.org/docs/books.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "inventory/intro.html",
    "href": "inventory/intro.html",
    "title": "1  在庫管理とは",
    "section": "",
    "text": "1.1 在庫モデルの分類\n商店・工場・倉庫などで、原材料・部品・製品などを適切に管理することを在庫管理（Inventory Management）という。一般的に、在庫管理の目的は、顧客の需要を満たしつつ、在庫に関わる費用を最小化することである。\n在庫が多すぎると、保管費用がかかる。逆に、在庫が少なすぎると、欠品が発生し、顧客の需要を満たせなくなる。在庫管理は次の二つの問題を決定する。\n科学的在庫管理（Scientific Inventory Management）では、これらの問題に答えるために、次の手順で在庫管理を行う。\n在庫モデルは、次のような要素で分類される。\n以下の表に、需要と観測に基づく、古典的な在庫モデルを示す。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>在庫管理とは</span>"
    ]
  },
  {
    "objectID": "inventory/intro.html#在庫モデルの分類",
    "href": "inventory/intro.html#在庫モデルの分類",
    "title": "1  在庫管理とは",
    "section": "",
    "text": "需要（demand）\n\n需要が決定論的 (Deterministic) か確率的（Stochastic）か。\n\n観測（review）\n\n在庫量を連続観測 (Continuous Review) するか、周期観測 (Periodic Review) するか。連続観測の場合、在庫量が連続的に観測でき、いつでも発注が可能である。周期観測の場合、一定の期間（例えば1週間）ごとに在庫量を観測する。\n\nリードタイム（lead time）\n\n発注から納品までの期間。調達期間とも呼ばれる。リードタイムが決定論的か確率的か。また、リードタイムが0かどうか。在庫モデルを単純化するために、リードタイムを0とし、発注から納品までの期間を無視することもある。\n\nバックオーダー（backorder）\n\nバックオーダーが許容されるかどうか。需要が在庫を上回った場合、バックオーダーが許容されると、欠品が発生しても、後で需要を満たすことができる。バックオーダーが許容されない場合、欠品が発生すると、上回った需要は失われ、機会損失が発生する。\n\n計画期間（planning horizon）\n\n単一期間 (Single Period) か、複数期間 (Multi Period) か、無限 (Infinite) か。\n\n\n\n\n\n\n在庫モデル\n需要\n観測\n\n\n\n\nEOQモデル\n決定論的\n連続観測\n\n\nWagner-Whitin\n決定論的\n周期観測\n\n\n安全在庫\n確率的\n連続観測\n\n\n新聞売り子問題\n確率的\n周期観測",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>在庫管理とは</span>"
    ]
  },
  {
    "objectID": "inventory/intro.html#在庫の費用",
    "href": "inventory/intro.html#在庫の費用",
    "title": "1  在庫管理とは",
    "section": "1.2 在庫の費用",
    "text": "1.2 在庫の費用\nここでは、在庫に関わる費用を紹介する。\n\n発注費用（ordering cost）\n\n発注量に関わらず、1回の発注にかかる費用。調達費用、固定費用（fixed cost）などとも呼ばれる。通常、1回の発注にかかる費用を \\(K\\) とする。\n\n購入費用（purchase cost）\n\n商品を購入するためにかかる費用。通常、単位あたりの購入費用を \\(c\\) とする。\n\n欠品費用（stockout cost）\n\n需要が在庫を上回った場合に発生する費用。通常、単位あたりの欠品費用を \\(p\\) とする。\n\n保管費用（holding cost）\n\n在庫を保管するためにかかる倉庫費用、保険費用、税金、機会費用など。通常、単位時間あたりの1単位あたりの保管費用を \\(h\\) とする。\n\n\n例えば、1日あたり1単位の在庫を保管するために、\\(h\\) の費用がかかるとする。30日間、50単位の在庫を保管するための総保管費用は \\(30 \\times 50 \\times h = 1500h\\) となる。下の図を見ると、保管費用は\n\\[\n\\text{面積} \\times h = 1500h\n\\]\nとなることがわかる。\n\n\nコード\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nt = np.linspace(0, 30, 1000)\ninventory = np.full_like(t, 50)\n\n# Plotting the inventory level\nplt.fill_between(t, inventory, color=\"lightgray\", alpha=0.5, label=\"Inventory Level\")\nplt.plot(t, inventory, label=\"Inventory Level\", color=\"black\", linewidth=2)\nplt.xlabel(\"Time\")\nplt.ylabel(\"Inventory Level\")\nplt.axhline(0, color=\"gray\", linewidth=1)\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n一般的に、在庫量が定数ではなく、時間とともに変化する。例えば、発注量を \\(500\\) とし、6 日間の在庫量を考える。\n\n\nコード\n# Parameters\nd = 250  # Demand rate\nQ = 500  # Order quantity\nT = Q / d  # Cycle length\nt = np.linspace(0, 2.999 * T, 1000)\n\n# Inventory level over time\ninventory = np.maximum(0, Q - (d * t) % Q)\n\n# Plotting the inventory level\nplt.fill_between(t, inventory, color=\"lightgray\", alpha=0.5, label=\"Inventory Level\")\nplt.plot(t, inventory, label=\"Inventory Level\", color=\"black\", linewidth=2)\nplt.xlabel(\"Time\")\nplt.ylabel(\"Inventory Level\")\nplt.axhline(0, color=\"gray\", linewidth=1)\nplt.ylim(bottom=0, top=Q + 200)\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n保管費用は次のように計算される。\n\\[\n\\frac{2 \\times 500}{2} \\times 3 \\times h\n\\]",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>在庫管理とは</span>"
    ]
  },
  {
    "objectID": "inventory/eoq.html",
    "href": "inventory/eoq.html",
    "title": "2  経済的発注量",
    "section": "",
    "text": "2.1 コスト関数\n経済的発注量（EOQ: Economic Order Quantity）モデルは、最も基本的な在庫管理モデルの一つである。Harris (1990) このモデルを最初に提案した。\nEOQモデルは、単位時間あたりの需要量は決定論的で、一定であると仮定する。すなわち、需要量は事前に分かっており、時間とともに変化しない。単位時間あたりの需要量は需要率（demand rate）と呼ばれ、記号 \\(d\\) で表される。リードタイムは0とし、発注から納品までの時間はないと仮定する。一回の発注量を \\(Q\\) とし、一定であるとする。欠品は許せないとする。全ての需要は満されなければならない。また、EOQモデルでは、在庫量は連続的に観測され、いつでも発注が可能であるとする。\n在庫に関わる費用は、発注費用 \\(K\\)、保管費用 \\(h\\) と、購入費用（購入単価を \\(c\\) と表す）がある。\nEOQモデルの最適解は次の二つの性質を持つ(Snyder と Shen 2019)：\n以上の性質から、在庫量の時間的変化は下図のようになる。\n発注の間隔をサイクル(cycle)と呼び、サイクル期間は\n\\[\nT = \\frac{Q}{d}\n\\]\nで与えられる。\nここでは、1サイクルあたりのコストを考える。\n発注費用：発注は1回だけ行うため、発注費用は \\(K\\) である。\n購入費用：\\(Q\\) 個の商品を単価 \\(c\\) で購入するため、購入費用は \\(cQ\\) である。\n保管費用：在庫量はサイクル期間 \\(T\\) の間に \\(Q\\) 個から0個まで減少するため、平均在庫量は \\(\\frac{Q}{2}\\) である。したがって、平均保管費用は \\(\\frac{hQ}{2}\\) である。サイクル期間 \\(T\\) は \\(\\frac{Q}{d}\\) であるため、1サイクルあたりの保管費用は\n\\[\n\\frac{hQ}{2} \\cdot T = \\frac{hQ^2}{2d}\n\\]\nとなる。\n以上より、1サイクルあたりのコストは次のように表される。\n\\[\nK + cQ + \\frac{hQ^2}{2d}\n\\]\n平均コストは、これをサイクル期間 \\(T\\) で割ったものとして定義される。したがって、平均コスト \\(g(Q)\\) は次のように表される。\n\\[\\begin{align*}\ng(Q) &= \\frac{1}{T} \\left( K + cQ + \\frac{hQ^2}{2d} \\right) \\\\\n&= \\frac{d}{Q} \\left( K + cQ + \\frac{hQ^2}{2d} \\right) \\\\\n&= \\frac{Kd}{Q} + c d + \\frac{hQ}{2}\n\\end{align*}\\]\n以上より、平均コストは発注量 \\(Q\\) の関数として次のように表される。\n\\[\ng(Q) = \\frac{Kd}{Q} + cd + \\frac{hQ}{2}\n\\]",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>経済的発注量</span>"
    ]
  },
  {
    "objectID": "inventory/eoq.html#最適発注量",
    "href": "inventory/eoq.html#最適発注量",
    "title": "2  経済的発注量",
    "section": "2.2 最適発注量",
    "text": "2.2 最適発注量\nEOQモデルの目的は、平均コスト \\(g(Q)\\) を最小化する発注量 \\(Q\\) を求めることである。\n平均コストの導関数 \\(g'(Q)\\) が 0 となる点を求めることで、最適発注量 \\(Q^*\\) を求めることができる。\n\\[\ng'(Q) = -\\frac{Kd}{Q^2} + \\frac{h}{2} = 0\n\\]\nこれを解くと、最適発注量\n\\[\nQ^* = \\sqrt{\\frac{2Kd}{h}}\n\\]\nを得る。これをEOQ公式（EOQ formula）と呼ぶ。\\(Q^*\\) を経済的発注量と呼ぶ（経済的は最適という意味である）。\n二階導関数 \\(g''(Q)\\) を求めて、最適発注量が最小値を与えることを確認する。\n\\[\ng''(Q) = \\frac{2Kd}{Q^3} &gt; 0\n\\]\n\\(g''(Q) &gt; 0\\) であるため、\\(Q^*\\) は最小値を与える。\n最適発注量 \\(Q^*\\) を次の定理にまとめる。\n\n定理 2.1 EOQモデルにおいて、最適発注量 \\(Q^*\\) は \\[\nQ^* = \\sqrt{\\frac{2Kd}{h}}\n\\]\nで与えられる。\n\n\\(Q^*\\) を用いて、最適なサイクル期間 \\(T^*\\) を求めることができる。\n\\[\nT^* = \\frac{Q^*}{d} = \\sqrt{\\frac{2K}{hd}}\n\\]\n\n注釈 2.1. 以下の性質がわかる。\n\n\\(Q^*\\) は \\(c\\) には依存しない。\n\\(h\\) の増加に伴い、\\(Q^*\\) は減少する。保管費用が高い場合は、少量で高い頻度で発注することが望ましい。\n\\(K\\) の増加に伴い、\\(Q^*\\) は増加する。発注費用が高い場合は、多量で低い頻度で発注することが望ましい。\n\n\n次の図は、発注コスト、保管コスト、平均コストの関係を示している。購入単価を \\(c = 0\\) とする。\n\n\nコード\n# Parameters\nK = 500  # Order cost\nh = 15  # Holding cost\nc = 0  # Purchase cost\nQ = np.linspace(1, 50, 50)\n\n# Average cost function\ng = (K / Q) + c + (h * Q / 2)\n\n# Plotting the costs vs order quantity\nplt.plot(Q, K / Q, label=\"Order Cost\", color=\"blue\", linewidth=2)\nplt.plot(Q, c + (h * Q / 2), label=\"Holding Cost\", color=\"orange\", linewidth=2)\nplt.plot(Q, g, label=\"Average Cost\", color=\"green\", linewidth=2)\nplt.axvline(\n    x=np.sqrt(2 * K / h),\n    color=\"red\",\n    linestyle=\"--\",\n    label=\"Optimal Order Quantity\",\n    linewidth=2,\n)\nplt.xlabel(\"Order Quantity (Q)\")\nplt.ylabel(\"Cost\")\nplt.tight_layout()\nplt.show()  \n\n\n\n\n\n\n\n\n\n平均コストが最小となる発注量 \\(Q^*\\) は、発注コストと保管コストの交差点である。すなわち、発注コストと保管コストを等しくする発注量は最適な発注量 \\(Q^*\\) である。この性質は以下の式からわかる。\n\\[\n\\frac{Kd}{Q^*} = \\frac{hQ^*}{2} \\Longrightarrow Q^* = \\sqrt{\\frac{2Kd}{h}}\n\\]\nまた、この図からもわかるように、\\(Q\\) の増加に伴い、平均発注コストは減少し、平均保管コストは増加する。逆もまた然りである。\n\n例 2.2 ある電気量販店では、毎月250台のPCが販売されている。発注費用は5000円、保管費用は1台あたり月150円、購入単価は10万円とする。このとき、最適発注量 \\(Q^*\\) は次のように求められる。\n\\[\nQ^* = \\sqrt{\\frac{2 \\cdot 5000 \\cdot 250}{150}}\n\\]\n最適発注量 \\(Q^*\\) を次で計算する。\n\ndef eoq(K, d, h):\n    \"\"\"\n    Calculate the Economic Order Quantity (EOQ).\n\n    Parameters:\n    K (float): Order cost\n    d (float): Demand rate\n    h (float): Holding cost\n\n    Returns:\n    float: Optimal order quantity Q*\n    \"\"\"\n    return np.sqrt(2 * K * d / h)\n\n\nif __name__ == \"__main__\":\n    K = 5000  # Order cost\n    d = 250  # Demand rate (units per month)\n    h = 150  # Holding cost (per unit per month)\n\n    Q_star = eoq(K, d, h)\n    print(f\"Optimal Order Quantity (Q*): {Q_star:.2f}\")\n\nOptimal Order Quantity (Q*): 129.10\n\n\nPCの場合は、注文量が整数である必要があるため、\\(g(129)\\) と \\(g(130)\\) を比較して最適発注量を決定する。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>経済的発注量</span>"
    ]
  },
  {
    "objectID": "inventory/eoq.html#リードタイム",
    "href": "inventory/eoq.html#リードタイム",
    "title": "2  経済的発注量",
    "section": "2.3 リードタイム",
    "text": "2.3 リードタイム\nEOQ モデルでは、リードタイムは0と仮定している。リードタイムが \\(L &gt; 0\\) の場合も、最適発注量 \\(Q^*\\) も変換せず、\\(L\\) 期間前に \\(Q^*\\) を発注すればよい。\nここでは、\\(r\\) を発注点（reorder point）とする。在庫量が \\(r\\) になったときに発注を行う。リードタイム \\(L\\) の間に需要が \\(dL\\) 個あるため、発注点は次のように表される。\n\\[\nr = dL\n\\]\n\n例 2.3 上の例で、リードタイムが一週間とし、一か月を4週間とすると、リードタイムは \\(L = 1/4\\) となる。したがって、発注点は次のように求められる。\n\\[\nr = dL = 250 \\times \\frac{1}{4} = 62.5\n\\]\nPCの在庫量が63台になったときに発注を行う。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>経済的発注量</span>"
    ]
  },
  {
    "objectID": "inventory/eoq.html#他のeoqモデル",
    "href": "inventory/eoq.html#他のeoqモデル",
    "title": "2  経済的発注量",
    "section": "2.4 他のEOQモデル",
    "text": "2.4 他のEOQモデル\n\nバックオーダーを考慮したEOQモデル\n数量割引（quantity discount）を考慮したEOQモデル\n\n総量割引（all-units discount）\n増分割引（incremental discount）\n\n\n\n\n\n\nHarris, Ford W. 1990. 「How many parts to make at once」. Oper. Res. 38 (6): 947–50.\n\n\nSnyder, Lawrence V, と Zuo-Jun Max Shen. 2019. Fundamentals of supply chain theory. 2nd 版. Nashville, TN: John Wiley & Sons.",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>経済的発注量</span>"
    ]
  },
  {
    "objectID": "inventory/wagner-whitin.html",
    "href": "inventory/wagner-whitin.html",
    "title": "3  Wagner-Whitin モデル",
    "section": "",
    "text": "記号\n意味\n\n\n\n\n\\(\\mathcal{T}\\)\n期間の集合、\\(\\mathcal{T} = \\{1, 2, \\ldots, T\\}\\)\n\n\n\\(K\\)\n1回あたりの発注費用\n\n\n\\(h\\)\n単位あたりの保管費用\n\n\n\\(d_t\\)\n第 \\(t\\) 期の需要量\n\n\n\\(q_t\\)\n第 \\(t\\) 期の発注量\n\n\n\\(x_t\\)\n第 \\(t\\) 期の在庫量\n\n\n\\(y_t\\)\n第 \\(t\\) 期に発注する場合は 1、しない場合は 0\n\n\n\\(M\\)\n非負の大きな数\n\n\n\nWagner-Whitin モデルは次のように定式化される。\n\\[\\begin{align}\n\\text{minimize} \\quad & \\sum_{t=1}^{T} (K y_t + h x_t) \\\\\n\\text{subject to} \\quad & x_t = x_{t-1} + q_t - d_t \\quad & \\forall t \\in \\mathcal{T} \\\\\n& q_t \\geq 0 \\quad & \\forall t \\in \\mathcal{T} \\\\\n& q_t \\leq M y_t \\quad & \\forall t \\in \\mathcal{T} \\\\\n& x_t \\geq 0 \\quad & \\forall t \\in \\mathcal{T} \\\\\n& y_t \\in \\{0, 1\\} \\quad & \\forall t \\in \\mathcal{T}\n\\end{align}\\]",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Wagner-Whitin モデル</span>"
    ]
  },
  {
    "objectID": "inventory/newsvendor.html",
    "href": "inventory/newsvendor.html",
    "title": "4  新聞売り子問題",
    "section": "",
    "text": "4.1 定式化\n新聞売り子問題（Newsvendor Problem）は、古典的な確率的在庫モデルの一つである。新聞は次の日には売れなくなるため、新聞売り子問題は最も単純な perishable 在庫モデルとして知られている。\n新聞売り子が新聞を仕入れ、販売する問題を考える。新聞 1 部の仕入れ価格を \\(c\\)、販売価格を \\(r\\)、残存価額を \\(v\\)、欠品費用を \\(p\\)、保管費用を \\(h\\) とする。ここで、以下の条件を満たすとする。\nまた、初期在庫は 0 であると仮定する。\n新聞の需要 \\(D\\) は正規分布 \\(N(\\mu, \\sigma^2)\\) に従い、\\(\\mu\\) と \\(\\sigma\\) は既知である。新聞売り子はどれだけの新聞を発注すればよいかという問題である。\nある日、新聞売り子が \\(S\\) 部の新聞を仕入れ、需要 \\(D\\) が \\(d\\) であったとする。このとき、新聞売り子の利益は以下のように表される。\n\\[\n\\pi(S, d) = r \\min\\{d, S\\} - cS + v \\max\\{0, S - d\\} \\\\\n- h \\max\\{0, S - d\\} - p \\max\\{0, d - S\\}\n\\]\n第一項は販売利益、第二項は仕入れコスト、第三項は残存価値、第四項は保管コスト、第五項は欠品コストである。\n以下は、\\(\\max\\{0, x\\} = x^+\\) を用いて書き換えた形である。整理すると、利益は以下のように表される。\n\\[\n\\pi(S, d) = r \\min\\{d, S\\} - cS + (v - h) (S - d)^+ - p (d - S)^+\n\\]\n第一項を以下のように書き換えることができる。\n\\[\nr \\min\\{d, S\\} = r d - r (d - S)^+\n\\]\nしたがって、利益は以下のように書き換えられる。\n\\[\n\\pi(S, d) = r d - cS + (v- h) (S - d)^+ - (p + r) (d - S)^+\n\\]\n利益の最大化は、コストの最小化に帰着される。したがって、コスト関数 \\(g(S, d) = -\\pi(S, d)\\) は以下のように表される。\n\\[\ng(S, d) = cS - rd + (h - v) (S - d)^+ + (p + r) (d - S)^+\n\\]\n\\(D\\) が確率変数であるため、コストの期待値 \\(g(S)\\) は以下のように表される。\n\\[\\begin{align}\ng(S) &= \\mathbb{E}[g(S, D)] \\\\\n&= \\int_{0}^{\\infty} g(S, d) f_D(d) dd \\\\\n&= cS - r\\mathbb{E}[D] + (h - v) \\mathbb{E}[(S - D)^+] + (p + r) \\mathbb{E}[(D - S)^+] \\\\\n&= c S - r \\mu + (h - v)  \\int_{0}^{\\infty}(S - d)^+ f_D(d) dd + (p + r) \\int_{0}^{\\infty} (d - S)^+ f_D(d) dd \\\\\n&= c S - r \\mu + (h - v) \\int_{0}^{S} (S - d) f_D(d) dd + (p + r) \\int_{S}^{\\infty} (d - S) f_D(d) dd\n\\end{align}\\]",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>新聞売り子問題</span>"
    ]
  },
  {
    "objectID": "inventory/newsvendor.html#定式化",
    "href": "inventory/newsvendor.html#定式化",
    "title": "4  新聞売り子問題",
    "section": "",
    "text": "ノート\n\n\n\n\\(A\\) は要素の間に順序が定義された集合とし、\\(\\min A\\) は、\\(A\\) の全ての要素の中で最小のものを表す。\n例えば、\\(\\min \\{1, 2, 3\\} = 1\\) である。\n\n\n\n\n\n\n\n\n\n\n\n\nノート\n\n\n\n\n\\(d &lt; S\\) の場合、\\(r \\min\\{d, S\\} = r d\\) となる。\n\\(d &gt;= S\\) の場合、\\(r \\min\\{d, S\\} = r d - r(d - S) = r S\\) となる。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>新聞売り子問題</span>"
    ]
  },
  {
    "objectID": "inventory/newsvendor.html#最適化",
    "href": "inventory/newsvendor.html#最適化",
    "title": "4  新聞売り子問題",
    "section": "4.2 最適化",
    "text": "4.2 最適化\n\\(g(S)\\) の1階微分は以下のように求める。\n\\[\\begin{align}\n\\frac{dg(S)}{dS} &= c + (h - v) F_D(S) - (p + r) (1 - F_D(S)) \\\\\n\\end{align}\\]\nよって、\\(dg(S)/dS = 0\\) から、\n\\[\\begin{align}\nc + (h - v) F_D(S) - (p + r) (1 - F_D(S)) &= 0 \\\\\nF_D(S) &= \\frac{p + r - c}{h + p + r - v}\n\\end{align}\\]\nになる。2 階微分は\n\\[\\begin{align}\n\\frac{d^2g(S)}{dS^2} &= (h - v) f_D(S) + (p + r) f_D(S) \\\\\n&= (h - v + p + r) f_D(S)\n\\end{align}\\]\nである。したがって、コスト関数 \\(g(S)\\) は凸関数であり、1 階微分が 0 になる点は最小値を与える。\nコスト関数 \\(g(S)\\) を最小化するための最適発注量 \\(S^*\\) は\n\\[\nS^* = F_D^{-1}\\left(\\frac{p + r - c}{h + p + r - v}\\right)\n\\] となる。ここで、\\(F_D^{-1}\\) は需要 \\(D\\) の累積分布関数の逆関数である。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>新聞売り子問題</span>"
    ]
  },
  {
    "objectID": "inventory/newsvendor.html#臨界率",
    "href": "inventory/newsvendor.html#臨界率",
    "title": "4  新聞売り子問題",
    "section": "4.3 臨界率",
    "text": "4.3 臨界率\n新聞売り子問題において、より一般的に、在庫超過費用（overage cost）と 在庫不足費用（underage cost）を考慮する。\n\\[\nC_o = h + c - v, \\quad C_u = p + r - c\n\\]\n在庫超過費用 \\(C_o\\) は、在庫が余ったときのコストである。1 部の在庫超過に対し、保管コストと仕入れコストが発生するが、残存価額が得られないため、\\(C_o = h + c - v\\) となる。\n在庫不足費用 \\(C_u\\) は、在庫が不足したときのコストである。1 部の在庫不足に対し、欠品コスト \\(p\\) と失われた販売機会の利益 \\(r - c\\) が発生するため、\\(C_u = p + r - c\\) となる。\n従って、\n\\[\\begin{align*}\nS^* &= F_D^{-1}\\left(\\frac{p + r - c}{h + p + r - v}\\right)\\\\\n&= F_D^{-1}\\left(\\frac{C_u}{C_o + C_u}\\right)\n\\end{align*}\\]\nが得られる。\n\n定理 4.1 新聞売り子問題における最適発注量 \\(S^*\\) は、\n\\[\nS^* = F_D^{-1}\\left(\\frac{C_u}{C_o + C_u}\\right)\n\\]\nで与えられる。\n\n\\(C_u/(C_o + C_u)\\) は臨界率（critical ratio）と呼ばれる。臨界率は、在庫不足費用と在庫超過費用の比率を表す。\nここで、\\(F_D(S) = P(D \\leq S)\\) は欠品が発生しない確率を表す。この確率のことはサービスレベル（service level）と呼ぶ。したがって、最適発注量 \\(S^*\\) を用いることは、サービスレベルを \\(C_u/(C_o + C_u)\\) に等しくすることを意味する。\\(1 - C_u/(C_o + C_u) = C_o/(C_o + C_u)\\) の確率で欠品が発生することが最適である。\n\n注釈 4.1. \n\n在庫不足費用 \\(C_u\\) の増加に伴い、サービスレベルと最適発注量 \\(S^*\\) は増加する。\n在庫超過費用 \\(C_o\\) の増加に伴い、サービスレベルと最適発注量 \\(S^*\\) は減少する。\n\n\n\n例 4.1 需要 \\(D\\) が正規分布 \\(N(100, 25)\\) に従う新聞売り子問題を考える。在庫超過費用が \\(C_o = 10\\)、在庫不足費用が \\(C_u = 40\\) のとき、最適発注量 \\(S^*\\) を求める。\n\\[\nS^* = F_D^{-1}\\left(\\frac{C_u}{C_o + C_u}\\right) = F_D^{-1}\\left(\\frac{40}{10 + 40}\\right) = F_D^{-1}\\left(0.8\\right)\n\\]\nここで、\\(F_D^{-1}\\) は需要 \\(D\\) の累積分布関数の逆関数である。Python では、SciPy ライブラリの ppf() 関数を用いて、逆関数を求めることができる。\n\nfrom scipy.stats import norm\n\n# 正規分布のパラメータ\nmu = 100\nsigma = 5\n\n# 在庫超過費用と在庫不足費用\nC_o = 10\nC_u = 40\n\n# 臨界率\ncritical_ratio = C_u / (C_o + C_u)\n\n# 最適発注量\nS_star = norm.ppf(critical_ratio, loc=mu, scale=sigma)\nprint(f\"Optimal order quantity S*: {S_star:.2f}\")\n\nOptimal order quantity S*: 104.21",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>新聞売り子問題</span>"
    ]
  },
  {
    "objectID": "inventory/newsvendor.html#初期在庫を考慮した新聞売り子問題",
    "href": "inventory/newsvendor.html#初期在庫を考慮した新聞売り子問題",
    "title": "4  新聞売り子問題",
    "section": "4.4 初期在庫を考慮した新聞売り子問題",
    "text": "4.4 初期在庫を考慮した新聞売り子問題\n新聞売り子の初期在庫を \\(I\\) とする。\\(L \\leq S^*\\)の場合、最適発注量は \\(S^* - I\\) となる。すなわち、在庫量を \\(S^*\\) にすればよい。\nまた、\\(g(S)\\) は凸関数であるため、\\(L &gt; S^*\\) の場合、何も発注しないことが最適である。\nしたがって、最適発注量は\n\\[\nQ =\n\\begin{cases}\nS^* - I, & \\text{if } L \\le S^*, \\\\[6pt]\n0, & \\text{if } L &gt; S^* .\n\\end{cases}\n\\]\nとなる。\nこのような発注方式を Base Stock Policy (BSP) と呼ぶ。BSP は、各期間の在庫量を観測し、在庫量が \\(S^*\\) に引き上げられるように発注する方式である。新聞売り子問題において、BSP は最適な方策であると知られている。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>新聞売り子問題</span>"
    ]
  },
  {
    "objectID": "inventory/newsvendor.html#発注費用を考慮した新聞売り子問題",
    "href": "inventory/newsvendor.html#発注費用を考慮した新聞売り子問題",
    "title": "4  新聞売り子問題",
    "section": "4.5 発注費用を考慮した新聞売り子問題",
    "text": "4.5 発注費用を考慮した新聞売り子問題\nScarf (1959) の論文では、\\((s, S)\\) 方策が発注費用を考慮した複数期間の新聞売り子問題において最適であることを示している。\n\n\n\n\nScarf, Herbert. 1959. 「The optimality of (S, s) policies in the dynamic inventory problem」.",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>新聞売り子問題</span>"
    ]
  },
  {
    "objectID": "inventory/safety.html",
    "href": "inventory/safety.html",
    "title": "5  安全在庫",
    "section": "",
    "text": "5.1 在庫方策\nこれまで紹介した在庫モデルは、需要が決定論的であると仮定していた。ここからは、需要が確率的であると仮定した在庫モデルを紹介する。\n確率的在庫モデルにおいて、一つ重要な概念は在庫方策（inventory policy）である。在庫方策は、在庫の状況に応じて、在庫管理のルールを定めるものである。代表的な在庫方策を以下に示す。\n一部の確率的在庫モデルにに対し、これらの在庫方策は最適であることが知られている。その場合、在庫方策が持つパラメータを最適化することで、在庫の期待コストを最小化することができる。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>安全在庫</span>"
    ]
  },
  {
    "objectID": "inventory/safety.html#在庫方策",
    "href": "inventory/safety.html#在庫方策",
    "title": "5  安全在庫",
    "section": "",
    "text": "\\((r, Q)\\) 方策：在庫量を連続的に観測し、在庫量が発注点 \\(r\\) 以下になったときに発注量 \\(Q\\) を発注する方式である。発注点方式とも呼ばれる。\nBSP 方策（Base Stock Policy）：在庫量を定期的に観測し、在庫量が基準在庫 \\(S\\) 以下になったときに、在庫量を \\(S\\) まで補充する方式である。定期発注方式とも呼ばれる。\n\\((s, S)\\) 方策：在庫量を定期的に観測し、在庫量が発注点 \\(s\\) 以下になったときに、在庫量を補充点 \\(S\\) まで補充する方式である。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>安全在庫</span>"
    ]
  },
  {
    "objectID": "inventory/safety.html#問題設定",
    "href": "inventory/safety.html#問題設定",
    "title": "5  安全在庫",
    "section": "5.2 問題設定",
    "text": "5.2 問題設定\n需要 \\(D\\) がある確率分布に従うと仮定する。リードタイムを \\(L\\) とし、既知の定数とする。発注費用を \\(K\\)、単位あたりの保管費用を \\(h\\) とする。在庫量が連続的に観測され、いつでも発注が可能であるとする連続観測の場合を考える。\n\\((r, Q)\\) 方策が用いられるとする。在庫量が発注点 \\(r\\) 以下になったときに、発注量 \\(Q\\) を発注する。この場合、発注点 \\(r\\) と発注量 \\(Q\\) を決定変数とし、在庫の期待コスト（expected cost）を最小化することを目的とする。\n\n\n\n\n\n\nノート\n\n\n\nこの問題の定式化および厳密解法は、ここでは説明しない。Snyder & Shen (2019) の「Fundamentals of Supply Chain Theory」などの文献を参照されたい。 以下は \\((r, Q)\\) の近似解法を紹介する。",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>安全在庫</span>"
    ]
  },
  {
    "objectID": "inventory/safety.html#近似解法",
    "href": "inventory/safety.html#近似解法",
    "title": "5  安全在庫",
    "section": "5.3 近似解法",
    "text": "5.3 近似解法\n以下では、単位期間あたりの需要を \\(D\\) とし、\\(D\\) は正規分布 \\(N(\\mu, \\sigma^2)\\) に従うと仮定する。ここで、\\(\\mu\\) は平均需要、\\(\\sigma\\) は需要の標準偏差である。\n\n5.3.1 発注量 \\(Q\\)\n\\(D\\) の平均 \\(\\mu\\) をEOQモデルの需要率とみなすと、発注量 \\(Q\\) は次のように求めることができる(Camm ほか 2022)。\n\\[\nQ = \\sqrt{\\frac{2K \\mu}{h}}\n\\]\nまた、欠品費用も考慮する場合、バックオーダーを考慮した EOQ モデルを用いて、発注量 \\(Q\\) は次のように求めることができる(Hillier と Lieberman 2025)。\n\\[\nQ = \\sqrt{\\frac{2K \\mu}{h}} \\sqrt{\\frac{p+h}{p}}\n\\] \\(p\\) は単位あたりの欠品費用である。\n得られた発注量 \\(Q\\) は、最適解ではなく、近似解であることに注意されたい。\n\n\n5.3.2 発注点 \\(r\\)\nリードタイム期間中に発生する需要は \\(D_L \\sim N(\\mu_L, \\sigma_L^2)\\) とし、正規分布の再生性により、\n\\[\n\\mu_L = \\mu L, \\quad \\sigma_L^2 = \\sigma^2 L\n\\]\nになる。すなわち、リードタイム期間中の平均需要は \\(\\mu_L = \\mu L\\)、標準偏差は \\(\\sigma_L = \\sigma \\sqrt{L}\\) である。\n発注点 \\(r\\) を決めるためには、サービスレベル（service level）を考える。ここでは、サービスレベルを、リードタイム期間中に需要を満たす確率と定義する。サービスレベルを \\(\\alpha\\) とし、\\(0 &lt; \\alpha &lt; 1\\) とする。\n与えられたサービスレベル \\(\\alpha\\) に対して、\\(D_L\\) が発注点 \\(r\\) 以下になる確率（欠品が発生しない確率、つまり、サービスレベル）が \\(\\alpha\\) になるように発注点 \\(r\\) を決定する。\n\\[\nP(D_L \\leq r) = \\alpha\n\\]\nもし、発注点 \\(r = \\mu_L\\) とすると、\\(P(D_L \\leq \\mu_L) = 0.5\\) となる。すなわち、50% の確率で欠品が発生することになる。\n\n\n\n\n\n\nノート\n\n\n\n\\[\nP(D_L \\leq \\mu_L) = P\\left(\\frac{D_L - \\mu_L}{\\sigma_L} \\leq 0\\right) = \\Phi(0) = 0.5\n\\]\n\n\nしたがって、サービスレベル \\(\\alpha &gt; 0.5\\) の場合、発注点 \\(r\\) は平均需要 \\(\\mu_L\\) より大きくなる必要がある。それを安全在庫（safety stock）と呼び、\\(s\\) と表す。\n\n例 5.1 単位期間あたりの需要 \\(D\\) が連続一様分布 \\(U(200, 300)\\) に従うと仮定する。平均需要は \\(\\mu = 250\\) である。一回の発注量を \\(Q = 500\\) とする。次の図は、在庫量の時間的変化を示す。灰色の領域は、需要の範囲を示す。赤い領域は、在庫量が0以下になったときの欠品を示す。黒い線は平均需要に基づく在庫量の変化を示す。\n\n\nコード\nimport scipy.stats as stats\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Parameters\nd_mean = 250  # Mean demand rate\nd_max = 300   # Max demand rate\nd_min = 200   # Min demand rate\nQ = 500       # Order quantity\nT = Q / d_mean  # Average cycle length\n\n# Simulate over multiple cycles to show repeated pattern\nn_cycles = 1\nt = np.linspace(0, n_cycles * T, 1000)\n\n# Inventory levels: linear depletion over time\ninventory_mean = Q - d_mean * (t % T)\ninventory_mean[0] = 0\ninventory_max = Q - d_max * (t % T)\ninventory_min = Q - d_min * (t % T)\n\n# Plotting\nplt.plot(t, inventory_mean, label=\"Mean Demand\", color=\"black\", linewidth=2)\nplt.fill_between(t, inventory_min, inventory_max, color=\"gray\", alpha=0.5, label=\"Demand Range\")\n\n# Highlight when inventory drops below 0 (shortage)\nplt.fill_between(t, inventory_max, 0, where=(inventory_max &lt; 0), color=\"red\", alpha=0.3, label=\"Shortage\")\n\n# Aesthetics\nplt.axhline(0, color=\"gray\", linewidth=1)\nplt.xlabel(\"Time\", fontsize=14)\nplt.ylabel(\"Inventory Level\", fontsize=14)\nplt.title(\"Inventory Level Over Time with Uniform Demand Distribution\")\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\nよって、発注点 \\(r\\) は次のように表される。\n\\[\nr = \\mu_L + s\n\\]\n従って、\\(P(D_L \\leq r) = \\alpha\\) は次のように表される。\n\\[\nP(D_L \\leq \\mu_L + s) = \\alpha\n\\]\nこの式を変形すると、\n\\[\\begin{align}\nP(D_L - \\mu_L \\leq s) &= \\alpha \\\\\nP\\left(\\frac{D_L - \\mu_L}{\\sigma_L} \\leq \\frac{s}{\\sigma_L}\\right) &= \\alpha \\\\\n\\Phi\\left(\\frac{s}{\\sigma_L}\\right) &= \\alpha \\\\\n\\frac{s}{\\sigma_L} &= \\Phi^{-1}(\\alpha) \\\\\ns &= \\sigma_L \\Phi^{-1}(\\alpha) \\\\\ns &= \\sigma \\sqrt{L} \\Phi^{-1}(\\alpha)\n\\end{align}\\]\nここで、\\(\\Phi(\\cdot)\\) は標準正規分布の累計分布関数であり、\\(\\Phi^{-1}(\\alpha)\\) はその逆関数である。したがって、発注点 \\(r\\) は次のように表される。\n\\[\nr = \\mu_L + s = \\mu L + \\sigma \\sqrt{L} \\Phi^{-1}(\\alpha)\n\\]\n\\(\\Phi^{-1}(\\alpha)\\) は標準正規分布表、Excel、Python などを用いて求めることができる。\n\n例 5.2 リードタイム \\(L = 4\\)、平均需要 \\(\\mu = 100\\)、需要の標準偏差 \\(\\sigma = 20\\)、サービスレベル \\(\\alpha = 0.95\\) のとき、発注点 \\(r\\) と安全在庫 \\(s\\) を求める。\nリードタイム期間中の平均需要と標準偏差は次のように計算される。\n\\[\\begin{align}\n\\mu_L &= \\mu L = 100 \\cdot 4 = 400 \\\\\n\\sigma_L &= \\sigma \\sqrt{L} = 20 \\sqrt{4} = 40 \\\\\n\\end{align}\\]\n標準正規分布表から \\(\\Phi^{-1}(0.95) \\approx 1.64485\\) を得る。これを用いて安全在庫 \\(s\\) と発注点 \\(r\\) を求める。\n\\[\\begin{align}\ns &= \\sigma_L \\Phi^{-1}(0.95) \\approx 40 \\cdot 1.64485 \\approx 65.79 \\\\\nr &= \\mu_L + s \\approx 400 + 65.79 \\approx 465.79\n\\end{align}\\]\nしたがって、発注点 \\(r\\) は約465.79、必要な安全在庫 \\(s\\) は約65.79となる。\nPython では、以下のように計算できる。\n\n\nコード\nfrom scipy.stats import norm\n\nL = 4\nmu = 100\nsigma = 20\nalpha = 0.95\n\nmu_L = mu * L\nsigma_L = sigma * (L ** 0.5)\n\ns = sigma_L * norm.ppf(alpha)\nr = mu_L + s\n\nprint(f\"reorder point: {r:.2f},  safety stock: {s:.2f}\")\n\n\nreorder point: 465.79,  safety stock: 65.79\n\n\n\n\n\n\n\nCamm, Jeffrey, James Cochran, Michael Fry, Jeffrey Ohlmann, David Anderson, Dennis Sweeney, と Thomas Williams. 2022. An introduction to management science: Quantitative approaches to decision making. 16th 版. Florence, AL: South-Western College Publishing.\n\n\nHillier, Frederick, と Gerald Lieberman. 2025. ISE introduction to operations research. 11th 版. Columbus, OH: McGraw-Hill Education.",
    "crumbs": [
      "在庫モデル",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>安全在庫</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Camm, Jeffrey, James Cochran, Michael Fry, Jeffrey Ohlmann, David\nAnderson, Dennis Sweeney, and Thomas Williams. 2022. An Introduction\nto Management Science: Quantitative Approaches to Decision Making.\n16th ed. Florence, AL: South-Western College Publishing.\n\n\nHarris, Ford W. 1990. “How Many Parts to Make at Once.”\nOper. Res. 38 (6): 947–50.\n\n\nHillier, Frederick, and Gerald Lieberman. 2025. ISE\nIntroduction to Operations Research. 11th ed. Columbus, OH:\nMcGraw-Hill Education.\n\n\nScarf, Herbert. 1959. “The Optimality of (S, s)\nPolicies in the Dynamic Inventory Problem.”\n\n\nSnyder, Lawrence V, and Zuo-Jun Max Shen. 2019. Fundamentals of\nSupply Chain Theory. 2nd ed. Nashville, TN: John Wiley & Sons.",
    "crumbs": [
      "References"
    ]
  }
]